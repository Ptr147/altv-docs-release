<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html class="theme-dark">
  
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>&#20803;&#25968;&#25454; </title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="title" content="&#20803;&#25968;&#25454; ">
    <meta name="generator" content="docfx 2.58.0.0">
    
    <link rel="shortcut icon" href="../favicon.ico">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jquery-modal/0.9.2/jquery.modal.min.css" integrity="sha512-T3VL1q6jMUIzGLRB9z86oJg9PgF7A55eC2XkB93zyWSqQw3Ju+6IEJZYBfT7E9wOHM7HCMCOZSpcssxnUn6AeQ==" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.3.1/styles/stackoverflow-dark.min.css" integrity="sha512-Xn1b0y/BrCD7usnEh6r9CcKxHXFVleVUjGDnfc95zDDwFUwtOz3lJC/XtJcuLRNyrMQJEEToFfwjC9Ue/aWY/g==" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.3.1/styles/stackoverflow-light.min.css" integrity="sha512-RDtnAhiPytLVV3AwzHkGVMVI4szjtSjxxyhDaH3gqdHPIw5qwQld1MVGuMu1EYoof+CaEccrO3zUVb13hQFU/A==" crossorigin="anonymous" disabled="disabled">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/solid.min.css" crossorigin="anonymous">
    <link rel="stylesheet" href="../styles/colors.css">
    <link rel="stylesheet" href="../styles/discord.css">
    <link rel="stylesheet" href="../styles/main.css">
    <meta property="docfx:navrel" content="../toc.html">
    <meta property="docfx:tocrel" content="../toc.html">
    
    <meta property="docfx:rel" content="../">
    
  </head>

  <body>

        <div class="body-content">

            <nav id="sidebar" role="navigation">

                <div class="sidebar">
                    
                    
                    
                    
                    <div>
                      
                      <a class="brand" href="../index.html">
                        <img src="../logo.svg" alt="alt:V" class="logomark">
                        <span class="brand-title">alt:V</span>
                      </a>
                      <div id="navbar">
                    
                      </div>
                    
                    </div>
                    


                </div>


            </nav>

            <main class="main-panel">

                <div class="blackout desktop-hide"></div>

                    
                    <div class="subnav navbar navbar-default">
                      <button class="btn-link search-back desktop-hide"></button>
                      <button class="btn-link navbar-toggler" aria-label="Toggle navigation"></button>
                      <div class="container" id="breadcrumb">
                        <ul class="breadcrumb">
                          <li></li>
                        </ul>
                      </div>
                      <div class="flex-space"></div>
                      <div class="toolbar">
                          <div style="position: relative; margin: 0 8px;">
                            <form class="search-bar mobile-hide" role="search" id="search" style="position: relative;">
                              <button class="btn-link clear" id="search-query-clear"></button>
                              <div role="textbox" class="form-control" id="search-query" placeholder="Search" contenteditable="true"></div>
                            </form>
                            <div class="popout" id="search-menu">
                                <button class="btn-link search-help" data-href="../articles/search_help.html"></button>
                              <span class="title">
                                Search options:
                              </span>
                            </div>
                            <button class="btn-link search-tip desktop-hide"></button>
                          </div>
                      </div>
                      <button class="btn-link btn-floating search desktop-hide"></button>
                      <div class="theme">
                        <button class="btn-link theme" aria-label="Switch theme"></button>
                        <div class="popout" id="theme-menu">
                          <div class="theme-option light" data-theme="light">
                            <span class="btn-link theme-light">Light</span>
                          </div>
                          <div class="theme-option dark" data-theme="dark">
                            <span class="btn-link theme-dark">Dark</span>
                          </div>
                          <div class="theme-option auto" data-theme="auto">
                            <span class="btn-link theme-auto">Sync with OS</span>
                          </div>
                        </div>
                      </div>
                    </div>

                <div class="content-region" role="main">

                    <div class="content-column Conceptual">

                            
                            <div class="sideaffix hide-when-search" data-noindex="">
                              <h3>Index</h3>
                              <div class="bs-docs-sidebar affix" id="affix"><ul class="level1 nav bs-docs-sidenav"><li><a href="#元数据">元数据</a></li><li><a href="#类型">类型</a><ul class="level2 nav bs-docs-sidenav 类型"><li><a href="#概览">概览</a></li><li><a href="#用法">用法</a></li><li><a href="#本地元local-meta">本地元(Local Meta)</a></li><li><a href="#同步元synced-meta">同步元(Synced Meta)</a></li><li><a href="#流同步元数据stream-synced-meta">流同步元数据(Stream Synced Meta)</a></li><li><a href="#谈论remarks">谈论(Remarks)</a></li></ul></li></ul></div>
                            </div>

                            
                            <div id="search-results">
                              <div class="search-list">Search Results for <span></span></div>
                              <div class="sr-items">
                                <p><span class="glyphicon glyphicon-refresh index-loading"></span></p>
                              </div>
                              <ul id="pagination" data-first="" data-prev="&#xf053;" data-next="&#xf054;" data-last=""></ul>
                            </div>

                        <article class="content wrap hide-when-search" id="_content" data-uid="">

                                <span class="small pull-right article mobile-hide" style="margin: 0;" data-noindex="">
                                    <ul class="subnav contribution">
                                            <li>
                                                <a href="https://github.com/Ptr147/altv-docs-cn/blob/master/articles/meta_data.md/#L1">Improve this Doc</a>
                                            </li>
                                    </ul>
                                </span>

<h1 id="元数据">元数据</h1>

<p>元数据可用于在服务器和客户端之间传递特定的值(也称为同步元数据或本地元数据),或在资源之间(全局元数据)绑定到一个实体或相应的一方(服务器或客户端)。<br>
例如,玩家的用户名可以绑定到它,或者警报器的状态绑定到一辆车(同步元数据)。<br>
同样,像当前天气这样的数据也可以绑定到资源作为元数据,以便其他资源可以查询这个值(全局元数据)。<br>
这些主题将在各自的子部分中更详细地讨论。</p>
<iframe width="1280" height="720" src="https://www.youtube-nocookie.com/embed/4oQTVkx5GA0" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe>
<h1 id="类型">类型</h1>
<h2 id="概览">概览</h2>
<table>
<thead>
<tr>
<th>类型</th>
<th>使用对象</th>
<th>可用性(设置)</th>
<th>可用性(获取)</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>元数据</td>
<td>实体,Alt</td>
<td>客户端和服务器</td>
<td>客户端和服务器</td>
<td>数据只在设置它的客户端或服务器端可用。</td>
</tr>
<tr>
<td>本地元数据</td>
<td>玩家</td>
<td>服务器</td>
<td>客户端和服务器</td>
<td>数据是设置在玩家身上的。只有设置它的客户端可以获取数据。</td>
</tr>
<tr>
<td>(全局)同步元数据</td>
<td>实体,Alt</td>
<td>服务器</td>
<td>客户端和服务器</td>
<td>数据可以在每个实体(玩家和车辆)上设置。每个客户端都可以获取数据。</td>
</tr>
<tr>
<td>流同步元数据</td>
<td>实体</td>
<td>服务器</td>
<td>客户端和服务器</td>
<td>这与同步元数据类似,但数据仅在实体处于客户端获取数据的流范围内时传输。</td>
</tr>
</tbody>
</table>
<h2 id="用法">用法</h2>
<p>元数据是使用 alt 类或实体(玩家或车辆)上的 setMeta 方法设置的。<br>
元数据只在设置它的同一侧可用,并且可以由所有资源获取。</p>
<div class="tabGroup" id="tabgroup_bHGHmlrG6S">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_bHGHmlrG6S_tab1-0" role="tab" aria-controls="tabpanel_bHGHmlrG6S_tab1-0" data-tab="tab1-0" tabindex="0" aria-selected="true">JS</a>
</li>
<li role="presentation">
<a href="#tabpanel_bHGHmlrG6S_tab1-1" role="tab" aria-controls="tabpanel_bHGHmlrG6S_tab1-1" data-tab="tab1-1" tabindex="-1">TS</a>
</li>
<li role="presentation">
<a href="#tabpanel_bHGHmlrG6S_tab1-2" role="tab" aria-controls="tabpanel_bHGHmlrG6S_tab1-2" data-tab="tab1-2" tabindex="-1">C#</a>
</li>
</ul>
<section id="tabpanel_bHGHmlrG6S_tab1-0" role="tabpanel" data-tab="tab1-0">

<p>应用全局元数据</p>
<pre><code class="lang-js">// 使用给定的键和值设置全局元数据(单侧,跨资源)  
alt.setMeta(&quot;metaKey&quot;, &quot;metaValue&quot;);
// 检查元数据是否设置并记录结果
if (alt.hasMeta(&quot;metaKey&quot;)) {
    alt.log(&quot;元数据被设置&quot;); 
} else {
    alt.log(&quot;元数据未设置&quot;);
}
// 获取并保存元数据的值
const metaValue = alt.getMeta(&quot;metaKey&quot;);  
// 删除元数据
alt.deleteMeta(&quot;metaKey&quot;);
</code></pre>
<p>将 全局元(global meta) 绑定应用于实体</p>
<pre><code class="lang-js">alt.on(&quot;playerConnect&quot;, (player) =&gt; {
    // Set a player meta (single-sided, cross-resource) with a given key and value
    player.setMeta(&quot;username&quot;, player.name);
    // 检查元是否已设置并记录结果
    if (player.hasMeta(&quot;username&quot;)) {
        alt.log(&quot;Meta is set&quot;);
    } else {
        alt.log(&quot;Meta isn't set&quot;);
    }
    // 获取并保存元的值
    const metaValue = player.getMeta(&quot;username&quot;);
    // 删除元
    player.deleteMeta(&quot;metaKey&quot;);
});
</code></pre>
<p>监听 全局元(global meta) 修改</p>
<pre><code class="lang-js">alt.on(&quot;globalMetaChange&quot;, (key, newValue, oldValue) =&gt; {
    // 当应用于alt的元发生更改时调用此事件
    // 您也可以使用 alt.hasMeta 和 alt.getMeta 方法自行检查
    if (alt.hasMeta(&quot;metaKey&quot;)) {
        const metaValue = alt.getMeta(&quot;metaKey&quot;);
        // &lt;使用该值做一些事情&gt;
    }
});
</code></pre>
</section>
<section id="tabpanel_bHGHmlrG6S_tab1-1" role="tabpanel" data-tab="tab1-1" aria-hidden="true" hidden="hidden">

<p>接口中的 元(meta) 声明(可以添加到.ts或.d.ts文件中)</p>
<pre><code class="lang-ts">declare module &quot;alt-shared&quot; {
  // 通过接口合并扩展接口
  export interface ICustomGlobalMeta {
    metaKey: string
  }
}
</code></pre>
<p>用法与JS中相同：</p>
<p><strong>Server &amp; Client</strong></p>
<pre><code class="lang-ts">const metaValue /* string | undefined */  = alt.getMeta(&quot;metaKey&quot;);
</code></pre>
</section>
<section id="tabpanel_bHGHmlrG6S_tab1-2" role="tabpanel" data-tab="tab1-2" aria-hidden="true" hidden="hidden">

<p>应用全局元(global meta)</p>
<pre><code class="lang-cs">// 使用给定的键和值设置全局元(单面/跨资源)
Alt.SetMetaData(&quot;metaKey&quot;, &quot;metaValue&quot;);
// 检查元是否已设置并记录结果
if (Alt.HasMetaData(&quot;metaKey&quot;))
{
    Alt.Log(&quot;Meta is set&quot;);
}
else
{
    Alt.Log(&quot;Meta isn't set&quot;);
}
// 获取并保存元的值
// 使用C#时，需要传递元值的类型
var valueIsFetched = Alt.GetMetaData&lt;string&gt;(&quot;metaKey&quot;, out var metaData);
// 删除元
Alt.DeleteMetaData(&quot;metaKey&quot;);
</code></pre>
<p>将全局元绑定应用于实体</p>
<pre><code class="lang-cs">Alt.OnPlayerConnect += (player, reason) =&gt;
{
    // 使用给定的键和值设置玩家元(单面/交叉资源)
    player.SetMetaData(&quot;username&quot;, player.Name);
    // 检查元是否已设置并记录结果
    if (player.HasMetaData(&quot;username&quot;))
    {
        Alt.Log(&quot;Meta is set&quot;);
    }
    else
    {
        Alt.Log(&quot;Meta isn't set&quot;);
    }
    // 获取并保存元的值
    // 使用C#时，需要传递元值的类型
    var valueIsFetched = player.GetMetaData&lt;string&gt;(&quot;username&quot;, out var metaData);
    // 删除元
    player.DeleteMetaData(&quot;metaKey&quot;);
};
</code></pre>
<p>侦听实体的元更改</p>
<pre><code class="lang-cs">Alt.OnMetaDataChange += (entity, key, value) =&gt;
{
    // 当应用于实体的元发生更改时调用此事件
    // 您也可以使用 entity.HasMetaData 或 entity.GetMetaData 方法自己检查它
    if (entity.HasMetaData(&quot;metaKey&quot;)) {
        var valueIsFetched = entity.GetMetaData&lt;string&gt;(&quot;metaKey&quot;, out var metaValue);
        // &lt;使用该值做一些事情&gt;
    }
};
</code></pre>
</section>
</div>
<h2 id="本地元local-meta">本地元(Local Meta)</h2>
<p>本地元总是设置为播放器实例，并且只能在服务器端进行修改。
这些数据可以从所有资源访问，但在客户端只能从设置元的相应播放器访问。</p>
<div class="tabGroup" id="tabgroup_bHGHmlrG6S-1">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_bHGHmlrG6S-1_tab2-0" role="tab" aria-controls="tabpanel_bHGHmlrG6S-1_tab2-0" data-tab="tab2-0" tabindex="0" aria-selected="true">JS</a>
</li>
<li role="presentation">
<a href="#tabpanel_bHGHmlrG6S-1_tab2-1" role="tab" aria-controls="tabpanel_bHGHmlrG6S-1_tab2-1" data-tab="tab2-1" tabindex="-1">TS</a>
</li>
<li role="presentation">
<a href="#tabpanel_bHGHmlrG6S-1_tab2-2" role="tab" aria-controls="tabpanel_bHGHmlrG6S-1_tab2-2" data-tab="tab2-2" tabindex="-1">C#</a>
</li>
</ul>
<section id="tabpanel_bHGHmlrG6S-1_tab2-0" role="tabpanel" data-tab="tab2-0">

<p><strong>Server</strong></p>
<p>将本地元绑定应用于实体</p>
<pre><code class="lang-js">alt.on(&quot;playerConnect&quot;, (player) =&gt; {
    // 使用给定的键和值设置玩家本地元(由服务器设置，同步到服务器和客户端，跨资源)
    player.setLocalMeta(&quot;username&quot;, player.name);
    // 检查是否设置了本地元并记录结果
    if (player.hasLocalMeta(&quot;username&quot;)) {
        alt.log(&quot;Meta is set&quot;);
    } else {
        alt.log(&quot;Meta isn't set&quot;);
    }
    // 获取并保存本地元的值
    const metaValue = player.getLocalMeta(&quot;username&quot;);
    // 删除元(仅在服务器上可用)
    player.deleteLocalMeta(&quot;username&quot;);
});
</code></pre>
<p>侦听本地元更改</p>
<pre><code class="lang-js">alt.on(&quot;localMetaChange&quot;, (player, key, newValue, oldValue) =&gt; {
    // 本地元更改时调用此事件
    // 您也可以使用p layer.hasLocalMeta 和 player.getLocalMeta 方法自行检查
    if (player.hasLocalMeta(&quot;metaKey&quot;)) {
        const metaValue = player.getLocalMeta(&quot;metaKey&quot;);
        // &lt;使用该值做一些事&gt;
    }
});
</code></pre>
<p><strong>Client</strong></p>
<p>检查是否设置了本地元</p>
<pre><code class="lang-js">alt.on(&quot;spawned&quot;, () =&gt; {
    // 检查是否设置了本地元
    if (alt.hasLocalMeta(&quot;username&quot;)) {
        alt.log(&quot;Meta is set&quot;);
    } else {
        alt.log(&quot;Meta isn't set&quot;);
        return;
    }
    // 获取并保存本地元的值
    const metaValue = alt.getLocalMeta(&quot;username&quot;);
});
</code></pre>
<p>侦听本地元更改</p>
<pre><code class="lang-js">alt.on(&quot;localMetaChange&quot;, (key, newValue, oldValue) =&gt; {
    // 本地元更改时调用此事件
    // 您也可以使用 alt.hasLocalMeta 和 alt.getLocalMeta 方法自行检查
    if (alt.hasLocalMeta(&quot;metaKey&quot;)) {
        const metaValue = alt.getLocalMeta(&quot;metaKey&quot;);
        // &lt;使用该值做一些事情&gt;
    }
});
</code></pre>
</section>
<section id="tabpanel_bHGHmlrG6S-1_tab2-1" role="tabpanel" data-tab="tab2-1" aria-hidden="true" hidden="hidden">

<p>接口中的元声明(可以添加到.ts或.d.ts文件中)</p>
<pre><code class="lang-ts">declare module &quot;alt-shared&quot; {
  // 通过接口合并扩展接口
  export interface ICustomPlayerLocalMeta {
    username: string
  }
}
</code></pre>
<p>用法与JS中相同:</p>
<p><strong>Server</strong></p>
<pre><code class="lang-ts">const metaValue /* string | undefined */ = player.getLocalMeta(&quot;username&quot;);
</code></pre>
<p><strong>Client</strong></p>
<pre><code class="lang-ts">const metaValue /* string | undefined */ = alt.getLocalMeta(&quot;username&quot;);
</code></pre>
</section>
<section id="tabpanel_bHGHmlrG6S-1_tab2-2" role="tabpanel" data-tab="tab2-2" aria-hidden="true" hidden="hidden">

<p><strong>Server</strong></p>
<p>将本地元绑定应用于实体</p>
<pre><code class="lang-cs">Alt.OnPlayerConnect += (player, reason) =&gt;
{
    // 使用给定键的和值设置玩家本地元(由服务器设置，同步到服务器和客户端，跨资源)
    player.SetLocalMetaData(&quot;username&quot;, player.Name);
    // 检查是否设置了本地元并记录结果
    if (player.HasLocalMetaData(&quot;username&quot;))
    {
        Alt.Log(&quot;Meta is set&quot;);
    }
    else
    {
        Alt.Log(&quot;Meta isn't set&quot;);
    }
    // 获取并保存本地元的值
    // 使用C#时，需要传递元值的类型
    var valueIsFetched = player.GetLocalMetaData&lt;string&gt;(&quot;username&quot;, out var metaData);
    // 删除元
    player.DeleteLocalMetaData(&quot;username&quot;);
};
</code></pre>
</section>
</div>
<h2 id="同步元synced-meta">同步元(Synced Meta)</h2>
<p>同步元被分发到所有资源和客户端，可以通过以下方式使用:</p>
<ul>
<li>全局（应用于alt）</li>
<li>绑定到实体（应用于玩家或车辆）</li>
</ul>
<div class="tabGroup" id="tabgroup_bHGHmlrG6S-2">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_bHGHmlrG6S-2_tab3-0" role="tab" aria-controls="tabpanel_bHGHmlrG6S-2_tab3-0" data-tab="tab3-0" tabindex="0" aria-selected="true">JS</a>
</li>
<li role="presentation">
<a href="#tabpanel_bHGHmlrG6S-2_tab3-1" role="tab" aria-controls="tabpanel_bHGHmlrG6S-2_tab3-1" data-tab="tab3-1" tabindex="-1">TS</a>
</li>
<li role="presentation">
<a href="#tabpanel_bHGHmlrG6S-2_tab3-2" role="tab" aria-controls="tabpanel_bHGHmlrG6S-2_tab3-2" data-tab="tab3-2" tabindex="-1">C#</a>
</li>
</ul>
<section id="tabpanel_bHGHmlrG6S-2_tab3-0" role="tabpanel" data-tab="tab3-0">

<p><strong>Server</strong></p>
<p>应用全局同步元</p>
<pre><code class="lang-js">// 使用给定的键和值设置全局同步元(服务器和客户端，跨资源)
alt.setSyncedMeta(&quot;metaKey&quot;, &quot;metaValue&quot;);
// 检查元是否已设置并记录结果
if (alt.hasSyncedMeta(&quot;metaKey&quot;)) {
    alt.log(&quot;Meta is set&quot;);
} else {
    alt.log(&quot;Meta isn't set&quot;);
}
// 获取并保存元的值
const metaValue = alt.getSyncedMeta(&quot;metaKey&quot;);
// 删除元
alt.deleteSyncedMeta(&quot;metaKey&quot;);
</code></pre>
<p>Applying a global synced meta bound to a entity</p>
<pre><code class="lang-js">alt.on(&quot;playerConnect&quot;, (player) =&gt; {
    // 使用给定的键和值设置同步元(服务器和客户端，跨资源)
    player.setSyncedMeta(&quot;metaKey&quot;, &quot;metaValue&quot;);
    // 检查元是否已设置并记录结果
    if (player.hasSyncedMeta(&quot;metaKey&quot;)) {
        alt.log(&quot;Meta is set&quot;);
    } else {
        alt.log(&quot;Meta isn't set&quot;);
    }
    // 获取并保存元的值
    const metaValue = player.getSyncedMeta(&quot;metaKey&quot;);
});
</code></pre>
<p>侦听同步的元更改</p>
<pre><code class="lang-js">alt.on(&quot;syncedMetaChange&quot;, (entity, key, newValue, oldValue) =&gt; {
    // 当应用于实体的同步元发生更改时调用此事件
    // 您也可以使用 entity.hasSyncedMeta(key) 方法自己进行检查
    if (entity.hasSyncedMeta(&quot;metaKey&quot;)) {
        const metaValue = entity.getSyncedMeta(&quot;metaKey&quot;);
        // &lt;使用该值做一些事情&gt;
    }
});
</code></pre>
<p><strong>Client</strong></p>
<p>正在检查是否设置了全局同步元</p>
<pre><code class="lang-js">alt.on(&quot;spawned&quot;, () =&gt; {
    // 检查是否设置了全局同步元
    if (alt.hasSyncedMeta(&quot;metaKey&quot;)) {
        alt.log(&quot;Meta is set&quot;);
    } else {
        alt.log(&quot;Meta isn't set&quot;);
    }
    // 获取并保存元的值
    const metaValue = alt.getSyncedMeta(&quot;metaKey&quot;);
});
</code></pre>
<p>侦听全局同步的元更改</p>
<pre><code class="lang-js">alt.on(&quot;globalSyncedMetaChange&quot;, (key, newValue, oldValue) =&gt; {
    // 当应用于 alt 的同步元发生更改时调用此事件
    // 您也可以使用 alt.hasSyncedMeta(key) 方法自行检查
    if (alt.hasSyncedMeta(&quot;metaKey&quot;)) {
        const metaValue = alt.getSyncedMeta(&quot;metaKey&quot;);
        // &lt;使用该值做一些事情&gt;
    }
});
</code></pre>
<p>侦听同步的元更改</p>
<pre><code class="lang-js">alt.on(&quot;syncedMetaChange&quot;, (entity, key, newValue, oldValue) =&gt; {
    // 当应用于实体的同步元发生更改时调用此事件
    // 您也可以使用 entity.hasSyncedMeta(key) 方法自己进行检查
    if (entity.hasSyncedMeta(&quot;metaKey&quot;)) {
        const metaValue = entity.getSyncedMeta(&quot;metaKey&quot;);
        // &lt;使用该值做一些事情&gt;
    }
});
</code></pre>
</section>
<section id="tabpanel_bHGHmlrG6S-2_tab3-1" role="tabpanel" data-tab="tab3-1" aria-hidden="true" hidden="hidden">

<p>接口中的元声明(可以添加到.ts或.d.ts文件中)</p>
<pre><code class="lang-ts">declare module &quot;alt-shared&quot; {
  // 通过接口合并扩展接口

  export interface ICustomGlobalSyncedMeta {
    globalMetaKey: string
  }

  export interface ICustomPlayerSyncedMeta {
    playerMetaKey: string
  }
}
</code></pre>
<p>用法与JS中相同:</p>
<p><strong>Server &amp; Client</strong></p>
<pre><code class="lang-ts">const globalMetaValue /* string | undefined */ = alt.getSyncedMeta(&quot;globalMetaKey&quot;);
const playerMetaValue /* string | undefined */ = player.getSyncedMeta(&quot;playerMetaKey&quot;);
</code></pre>
</section>
<section id="tabpanel_bHGHmlrG6S-2_tab3-2" role="tabpanel" data-tab="tab3-2" aria-hidden="true" hidden="hidden">

<p><strong>Server</strong></p>
<p>应用全局元</p>
<pre><code class="lang-cs">Alt.OnPlayerConnect += (player, reason) =&gt;
{
    // 使用给定键的和值设置玩家本地元(由服务器设置，同步到服务器和客户端，跨资源)
    player.SetLocalMetaData(&quot;username&quot;, player.Name);
    // 检查是否设置了本地元并记录结果
    if (player.HasLocalMetaData(&quot;username&quot;))
    {
        Alt.Log(&quot;Meta is set&quot;);
    }
    else
    {
        Alt.Log(&quot;Meta isn't set&quot;);
    }
    // 获取并保存本地元的值
    // 使用C#时，需要传递元值的类型
    var valueIsFetched = player.GetLocalMetaData&lt;string&gt;(&quot;username&quot;, out var metaData);
    // 删除元
    player.DeleteMetaData(&quot;username&quot;);
};
</code></pre>
</section>
</div>
<h2 id="流同步元数据stream-synced-meta">流同步元数据(Stream Synced Meta)</h2>
<p>同步元被分发到所有资源和客户端，并且可以绑定到实体使用。
它基本上与同步元相同，但只发送到实体流范围内的客户端。</p>
<div class="tabGroup" id="tabgroup_bHGHmlrG6S-3">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_bHGHmlrG6S-3_tab4-0" role="tab" aria-controls="tabpanel_bHGHmlrG6S-3_tab4-0" data-tab="tab4-0" tabindex="0" aria-selected="true">JS</a>
</li>
<li role="presentation">
<a href="#tabpanel_bHGHmlrG6S-3_tab4-1" role="tab" aria-controls="tabpanel_bHGHmlrG6S-3_tab4-1" data-tab="tab4-1" tabindex="-1">TS</a>
</li>
<li role="presentation">
<a href="#tabpanel_bHGHmlrG6S-3_tab4-2" role="tab" aria-controls="tabpanel_bHGHmlrG6S-3_tab4-2" data-tab="tab4-2" tabindex="-1">C#</a>
</li>
</ul>
<section id="tabpanel_bHGHmlrG6S-3_tab4-0" role="tabpanel" data-tab="tab4-0">

<p><strong>Server</strong></p>
<p>将流同步元绑定到实体</p>
<pre><code class="lang-js">alt.on(&quot;playerConnect&quot;, (player) =&gt; {
    // 使用给定的密钥和值设置流同步元(服务器和客户端，跨资源)
    player.setStreamSyncedMeta(&quot;metaKey&quot;, &quot;metaValue&quot;);
    // 检查元是否已设置并记录结果
    if (player.hasStreamSyncedMeta(&quot;metaKey&quot;)) {
        alt.log(&quot;Meta is set&quot;);
    } else {
        alt.log(&quot;Meta isn't set&quot;);
    }
    // 获取并保存元的值
    const metaValue = player.getStreamSyncedMeta(&quot;metaKey&quot;);
    // 删除元
    player.deleteStreamSyncedMeta(&quot;metaKey&quot;);
});
</code></pre>
<p>侦听流同步的元更改</p>
<pre><code class="lang-js">alt.on(&quot;streamSyncedMetaChange&quot;, (entity, key, newValue, oldValue) =&gt; {
    // 当应用于实体的流同步元发生更改时调用此事件
    // 您也可以使用 entity.hasStreamSyncedMeta(key) 方法自行检查
    if (entity.hasStreamSyncedMeta(&quot;metaKey&quot;)) {
        const metaValue = entity.getStreamSyncedMeta(&quot;metaKey&quot;);
        // &lt;使用该值做一些事情&gt;
    }
});
</code></pre>
<p><strong>Client</strong></p>
<p>侦听流同步的元更改 (basically the same as on the server side)</p>
<pre><code class="lang-js">alt.on(&quot;streamSyncedMetaChange&quot;, (entity, key, newValue, oldValue) =&gt; {
    // 当应用于实体的流同步元发生更改时调用此事件
    // 您也可以使用 entity.hasStreamSyncedMeta(key) 方法自行检查
    if (entity.hasStreamSyncedMeta(&quot;metaKey&quot;)) {
        const metaValue = entity.getStreamSyncedMeta(&quot;metaKey&quot;);
        // &lt;使用该值做一些事情&gt;
    }
});
</code></pre>
</section>
<section id="tabpanel_bHGHmlrG6S-3_tab4-1" role="tabpanel" data-tab="tab4-1" aria-hidden="true" hidden="hidden">

<p>接口中的元声明(可以添加到.ts或.d.ts文件中)</p>
<pre><code class="lang-ts">declare module &quot;alt-shared&quot; {
  // 通过接口合并扩展接口

  // alt.Player and alt.Vehicle
  export interface ICustomEntityStreamSyncedMeta {
    entityMetaKey: string
  }

  // only alt.Player
  export interface ICustomPlayerStreamSyncedMeta {
    playerMetaKey: number
  }

  // only alt.Vehicle
  export interface ICustomVehicleStreamSyncedMeta {
    vehicleMetaKey: boolean
  }
}
</code></pre>
<p>用法与JS中相同:</p>
<p><strong>Server &amp; Client</strong></p>
<pre><code class="lang-ts">const entityMetaValue /* string | undefined */ = entity.getSyncedMeta(&quot;entityMetaKey&quot;);
const playerMetaValue /* number | undefined */ = player.getSyncedMeta(&quot;playerMetaKey&quot;);
const vehicleMetaValue /* boolean | undefined */ = vehicle.getSyncedMeta(&quot;vehicleMetaKey&quot;);
</code></pre>
</section>
<section id="tabpanel_bHGHmlrG6S-3_tab4-2" role="tabpanel" data-tab="tab4-2" aria-hidden="true" hidden="hidden">

<p><strong>Server</strong></p>
<p>将流同步元绑定到实体</p>
<pre><code class="lang-cs">Alt.OnPlayerConnect += (player, reason) =&gt;
{
    // 使用给定的键和值设置流同步元(由服务器设置，同步到服务器和客户端，跨资源)
    player.SetStreamSyncedMetaData(&quot;username&quot;, player.Name);
    // Check if the stream synced meta is set and log the result
    if (player.HasStreamSyncedMetaData(&quot;username&quot;))
    {
        Alt.Log(&quot;Meta is set&quot;);
    }
    else
    {
        Alt.Log(&quot;Meta isn't set&quot;);
    }
    // 获取并保存流同步元数据的值
    // 使用C#时，需要传递元值的类型
    var valueIsFetched = player.GetStreamSyncedMetaData&lt;string&gt;(&quot;username&quot;, out var metaData);
    // 删除元
    player.DeleteStreamSyncedMetaData(&quot;username&quot;);
};
</code></pre>
</section>
</div>
<h2 id="谈论remarks">谈论(Remarks)</h2>
<div class="WARNING">
<h5>Warning</h5>
<p>只有当客户端还不知道（新的）数据时，才会调用元更改事件。
如果此数据已知，则必须独立查询和处理，例如通过 gameEntityCreate 事件。</p>
</div>
<p>让我们以 <strong>streamSyncedMeta</strong> 的示例案例为例,其中键为 <code>trackWidth</code> 用于设置车辆的轨道宽度。</p>
<p>仅当客户端还不知道此值时,才会调用事件 <code>streamSyncedMetaChange</code> \<br>
如果现在离开流范围,然后返回到该范围,则会创建车辆,但不会触发 'streamSyncedMetaChange' 事件。
要确保始终应用值,还必须使用 <code>gameEntityCreate</code> 事件。</p>
<p>这里是一个示例:</p>
<div class="tabGroup" id="tabgroup_bHGHmlrG6S-4">
<ul role="tablist">
<li role="presentation">
<a href="#tabpanel_bHGHmlrG6S-4_tab5-0" role="tab" aria-controls="tabpanel_bHGHmlrG6S-4_tab5-0" data-tab="tab5-0" tabindex="0" aria-selected="true">Server</a>
</li>
<li role="presentation">
<a href="#tabpanel_bHGHmlrG6S-4_tab5-1" role="tab" aria-controls="tabpanel_bHGHmlrG6S-4_tab5-1" data-tab="tab5-1" tabindex="-1">Client</a>
</li>
</ul>
<section id="tabpanel_bHGHmlrG6S-4_tab5-0" role="tabpanel" data-tab="tab5-0">

<pre><code class="lang-js">const vehicle = new alt.Vehicle(&quot;t20&quot;, 0, 0, 72, 0, 0, 0);
vehicle.setStreamSyncedMeta(&quot;trackWidth&quot;, 0.85);
</code></pre>
</section>
<section id="tabpanel_bHGHmlrG6S-4_tab5-1" role="tabpanel" data-tab="tab5-1" aria-hidden="true" hidden="hidden">

<pre><code class="lang-js">// 这在元数据首次向客户端通信时调用
alt.on(&quot;streamSyncedMetaChange&quot;, (entity, key, newValue, oldValue) =&gt; {
    if (key === &quot;trackWidth&quot;) setTrackWidth(entity, newValue);
});

// 这在客户端上首次创建车辆时立即调用
// 在这里,我们检查车辆是否具有元数据,如果是,则处理它
alt.on(&quot;gameEntityCreate&quot;, (entity) =&gt; {
    if (entity.hasStreamSyncedMeta(&quot;trackWidth&quot;)) {
        const trackWidth = entity.getStreamSyncedMeta(&quot;trackWidth&quot;);
        setTrackWidth(entity, trackWidth);
    }
});

// 如果适用,可以使用 `gameEntityDestroy` 事件来撤消只在实体存在时才存在的更改
alt.on(&quot;gameEntityDestroy&quot;, (entity) =&gt; {
   // 例如,删除元数据更改
});

// 为了避免在两个事件中重复代码,我们将其移动到自己的函数中
function setTrackWidth(entity, trackWidth) {
    for (let i = 0; i &lt; entity.wheelsCount; i++) {
        entity.setWheelTrackWidth(i, trackWidth);
    }
}
</code></pre>
</section>
</div>
</article>
                    </div>

                </div>

            </main>

        </div>

        
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/arrive/2.4.1/arrive.min.js" integrity="sha512-wkU3qYWjenbM+t2cmvw2ADRRh4opbOYBjkhrPGHV7M6dcE/TR0oKpoDkWXfUs3HrulI2JFuTQyqPLRih1V54EQ==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/twbs-pagination/1.4.2/jquery.twbsPagination.min.js" integrity="sha512-frFP3ZxLshB4CErXkPVEXnd5ingvYYtYhE5qllGdZmcOlRKNEPbufyupfdSTNmoF5ICaQNO6SenXzOZvoGkiIA==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha512-mhbv5DqBMgrWL+32MmsDOt/OAvqr/cHimk6B8y/bx/xS88MVkYGPiVv2ixKVrkywF2qHplNRUvFsAHUdxZ3Krg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-modal/0.9.2/jquery.modal.min.js" integrity="sha512-ztxZscxb55lKL+xmWGZEbBHekIzy+1qYKHGZTWZYH1GUwxy0hiA18lW6ORIMj4DHRgvmP/qGcvqwEyFFV7OYVQ==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.3.0/anchor.min.js" integrity="sha512-G2OGlm41XXw+fcgDcRPjVYEn7qCY6qiKWNqDGT37SnKh0qtRXTuKZ5/UQR0kDN0PZRNWcGExd3lAeqEH0I36bQ==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/js-url/1.8.8/url.min.js" integrity="sha512-r7Z8tYN1iMr6CTQ7pNJa2q+3owm4Tc6dLkVzGV68AFGiI0muMh5eLVQlas5kb9qwPY168HsTBctUwn3k0FVqyw==" crossorigin="anonymous"></script>
<script type="text/javascript" src="../styles/docfx.js"></script>
<script type="text/javascript" src="../styles/discord.js"></script>
<script type="text/javascript" src="../styles/main.js"></script>

    </body>

</html>
